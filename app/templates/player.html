<!-- extned from base layout -->
{% extends "layout.html" %}

{% block content %}
  <title>Audiobook Player</title>
    <h1>Play on player</h1>

    {% if booktitle %}
    <h3>{{ booktitle }}</h3>
    {% else %}
    <h3>No Title Present</h3>
    {% endif %}

    <audio onclick="play(this)" id='audio' controls="true">
      <source src="static/audio/foo/foo.mp3" >
      Your browser does not support the audio element.
    </audio>

    <div>
      <ul style="list-style-type:none">
      {% for book in booklist %}
          <!-- <li>{{ book }}</li> -->
          <li><a href="javascript:void(0);">{{book}}</a></li>
      {% endfor %}
      </ul>
    </div>

    <script type='text/javascript'>

    document.body.onkeypress = function(e){
      if(e.keyCode == 32){
        console.log('space bar pressed')
        if (aud.paused) {
          console.log('status is paused')
          console.log('playing')
          aud.play()
        } else {
          console.log('pausing')
          aud.pause()
        }
        //aud.addEventListener('pause',aud.play())
        //aud.addEventListener('playing',aud.pause())
      }
    }
    console.log('start!')
    var aud = document.getElementById('audio')
    console.log('aud.paused state: '+aud.paused)
    //console.log('aud = '+aud)
    aud.addEventListener('pause', getTime)
    // jQuery $('#aud').on('pause', getTime)
    function getTime (){
      console.log('current time = '+aud.currentTime)
    }

      {% for book in booklist %}
         $('li').click(function(){
           var str = $(this).text()
           $('audio').attr('src', '/static/audio/'+str);
         });
      {% endfor %}

    </script>

{% endblock %}
